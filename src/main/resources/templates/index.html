<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PlantUMLCheck â€“ Home</title>
    <link rel="stylesheet" href="/css/app.css" />
    <style>
      /* Sticky footer for the homepage continue button, keeps existing styling intact */
      .sticky-actions {
        position: sticky;
        bottom: 0;
        background: #fff;
        border-top: 1px solid #e7e9f0;
        box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.06);
        padding: 14px 18px;
        z-index: 5;
      }
      .sticky-actions .actions {
        margin: 0; /* override any top margins so the bar is tight */
      }
    </style>
  </head>
  <body>
    <header class="app-header">
      <h1 class="app-title">PlantUMLCheck</h1>
      <p class="app-subtitle">Consistency checking between UML and Java code</p>
    </header>

    <main class="content">
      <div class="alert error" th:if="${error}" th:text="${error}"></div>

      <!-- Header + Code-only -->
      <section class="hero inline">
        <div>
          <h2>Choose your inputs</h2>
          <p class="muted">
            Turn on <em>Code-only</em> to skip PlantUML scripts and create
            diagram based on Source Code only.
          </p>
        </div>
        <div class="controls">
          <label
            class="toggle"
            title="Skip PlantUML scripts and generate from code only"
          >
            <input id="codeonly-toggle" type="checkbox" />
            <span class="slider"></span>
            <span class="label">Code-only</span>
          </label>
        </div>
      </section>

      <form
        id="upload-form"
        class="upload-form"
        th:action="@{/analyze}"
        method="post"
        enctype="multipart/form-data"
      >
        <input type="hidden" id="codeOnly" name="codeOnly" value="false" />

        <section class="dropzones" id="dz-container">
          <!-- SOURCE -->
          <div class="card dropzone" id="source-box" data-kind="src">
            <div class="card-head">
              <div class="title-row">
                <span class="step required">Step 1</span>
                <h2 class="card-title">Source code</h2>
              </div>
              <div class="inline-actions">
                <button
                  class="btn secondary"
                  type="button"
                  id="source-clear"
                  title="Remove all"
                >
                  Clear
                </button>
              </div>
            </div>

            <p class="badge">Accepted: folders or .java files</p>

            <!-- Drop hint -->
            <div class="drop-hint">Drag &amp; drop here or</div>

            <!-- one button; native input hidden -->
            <input
              id="source-input"
              class="file-input"
              type="file"
              name="source"
              multiple
              webkitdirectory
              directory
              accept=".java"
            />
            <label for="source-input" class="btn choose-btn"
              >Choose files / folder</label
            >

            <div id="source-summary" class="muted" style="margin-top: 0.5rem">
              No source selected yet.
            </div>
            <ul id="source-list" class="file-list"></ul>
          </div>

          <!-- PLANTUML -->
          <div class="card dropzone" id="puml-box" data-kind="puml">
            <div class="card-head">
              <div class="title-row">
                <span class="step optional">Step 2</span>
                <h2 class="card-title">PlantUML diagram script(s)</h2>
              </div>
              <div class="inline-actions">
                <button
                  class="btn secondary"
                  type="button"
                  id="puml-clear"
                  title="Remove all"
                >
                  Clear
                </button>
              </div>
            </div>

            <p class="badge">
              Accepted: folders or .puml, .plantuml, .iuml, .txt
            </p>

            <!-- Drop hint -->
            <div class="drop-hint">Drag &amp; drop here or</div>

            <input
              id="plantuml-input"
              class="file-input"
              type="file"
              name="plantuml"
              multiple
              webkitdirectory
              directory
              accept=".puml,.plantuml,.iuml,.txt"
            />
            <label for="plantuml-input" class="btn choose-btn"
              >Choose files / folder</label
            >

            <div
              id="puml-summary"
              class="muted center"
              style="margin-top: 0.5rem"
            >
              Optional. You can leave this empty if Code-only is ON.
            </div>
            <ul id="plantuml-list" class="file-list"></ul>
          </div>
        </section>

        <!-- Sticky continue bar -->
        <div class="sticky-actions">
          <div class="actions center">
            <button type="submit" class="btn primary" id="continue-btn">
              Continue
            </button>
          </div>
        </div>
      </form>
    </main>

    <script>
      document.documentElement.classList.add(
        "webkitdirectory" in document.createElement("input")
          ? "has-dir"
          : "no-dir"
      );
    </script>
    <script src="/js/upload.js?v=20" defer></script>
  </body>
</html>
